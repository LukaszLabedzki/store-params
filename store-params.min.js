!function(e,o){"function"==typeof define&&define.amd?define([],o):"object"==typeof module&&module.exports?module.exports=o():e.StoreParams=o()}(this,function(){var e=function(o){"use strict";var t=Object.create(e.prototype);t.options={storage:"cookies",cookieDuration:14,cookieDomain:!1,storeUTMs:!0,storeReferrer:!0,include:[],exclude:[],callback:function(){}},o&&Object.keys(o).forEach(function(e){t.options[e]=o[e]});var n=document.referrer?new URL(document.referrer):null,r=new URL(document.location.href),i=new URLSearchParams(r.search);if(t.options.cookieDomain||(t.options.cookieDomain="."+r.hostname.replace(/^(www\.)/,"")),t.options.storeUTMs){var a=[{param:"utm_medium"},{param:"utm_campaign"},{param:"utm_term"},{param:"utm_content"}];t.options.include=t.options.include.concat(a)}switch(t.options.storage){case"cookies":var c=function(e,o){var n=t.options.cookieDuration;""==o&&(n=-1);var r="";if(t.options.cookieDuration){var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3),r="; expires="+i.toUTCString()}document.cookie=e+"="+o+r+";domain="+t.options.cookieDomain+"; path=/"},s=function(e){for(var o=e+"=",t=document.cookie.split(";"),n=0;n<t.length;n++){for(var r=t[n];" "==r.charAt(0);)r=r.substring(1,r.length);if(0==r.indexOf(o))return r.substring(o.length,r.length)}return null},u=function(e){c(e,"")};break;case"localStorage":var m=window.localStorage,c=function(e,o){m.setItem(e,o)},s=function(e){return m.getItem(e)},u=function(e){m.removeItem(e)};break;case"sessionStorage":var l=window.localStorage,c=function(e,o){l.setItem(e,o)},s=function(e){return l.getItem(e)},u=function(e){l.removeItem(e)}}return t.read=function(e){return s(e)},function(){if(t.options.storeUTMs){if(a.filter(function(e){return i.has(e.param)}).length||n&&n.hostname!==r.hostname){u("utm_source");for(o=0;o<a.length;o++)u(a[o].param)}if(!t.options.exclude.includes("utm_source")){var e=null;i.has("utm_source")?e=i.get("utm_source"):n&&n.hostname!==r.hostname&&(e=n.hostname.replace(/^(www\.)/,"")),null!==e&&c("utm_source",e)}}for(var o=0;o<t.options.include.length;o++)!0!==i.has(t.options.include[o].param)||t.options.exclude.includes(t.options.include[o].param)||(t.options.include[o].storage?c(t.options.include[o].storage,i.get(t.options.include[o].param)):c(t.options.include[o].param,i.get(t.options.include[o].param)));t.options.storeReferrer&&n&&n.hostname!==r.hostname&&c("referrer",n.href)}(),t};return e});